---
import { SITE } from '@/config';
import Posts from '@/layouts/Posts.astro';
import type { GetStaticPathsOptions } from 'astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
  const allBlogPosts = await getCollection('blog');
  return paginate(
    allBlogPosts.toSorted((a, b) =>
      a.data.pubDatetime > b.data.pubDatetime ? 1 : a.data.pubDatetime < b.data.pubDatetime ? -1 : 0,
    ),
    { pageSize: SITE.postPerPage },
  );
}

const { page } = Astro.props;
---

<Posts posts={page.data} pageNum={page.currentPage} totalPages={page.lastPage} />
